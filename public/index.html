<!DOCTYPE html>
<html>
<head>
	<title>
		Sense4us Simulator
	</title>
	<script src="js/easeljs-NEXT.min.js"></script>
	<script src="js/jquery-1.11.1.js"></script>
	<script src="js/socket.io.js"></script>
	<link rel="stylesheet" href="css/style.css" />
</head>
<body>
	<div id="menu">
		<div class="inner_menu" id="edit_menu">
			<input type="button" class="button" onclick="create_origin_node(null, 0, 0);" value="Create origin" />
			<input type="button" class="button" onclick="create_node(null, 0, 0);" value="Create node" />
		</div>

		<div class="inner_menu" id="view_menu">
			<input type="button" class="button" onclick="sense4us.simulation.run();" value="Simulate" />
			<input id="sense4us_timelag" type="text" value="0" />
		</div>

		<div id="inspector"></div>
	</div>

	<div id="container">
		<div id="upper_menu">
			<h2>Mode:</h2>
			<input type="button" class="button" onclick="sense4us.menu.open('edit');" value="Modeling" />
			<input type="button" class="button" onclick="sense4us.menu.open('view');" value="Simulation" />
		</div>
		<canvas id="canvas" height="1" width="1" ></canvas>
		<div style="position: absolute; display: none;" id="edit_signal_fire">Sense4us Simulator</div>
	</div>

	<div style="clear: left"></div>

	<script src="js/get_or_create_html_entity.js"></script>
	<script src="js/select_object.js"></script>
	<script src="js/events.js"></script>
	<script src="js/init_easeljs.js"></script>
	<script src="js/network.js"></script>
	<script src="js/inspector.js"></script>

	<script src="js/entities/entity.js"></script>
	<script src="js/entities/node.js"></script>
	<script src="js/entities/link.js"></script>
	<script src="js/entities/selection_menu.js"></script>

	<script src="js/mechanics/selectable.js"></script>
	<script src="js/mechanics/draggable.js"></script>
	<script src="js/mechanics/selection_menu.js"></script>

	<script src="js/graphics/color.js"></script>
	<script src="js/graphics/graphic.js"></script>
	<script src="js/graphics/floating_input_field.js"></script>
	<script src="js/graphics/selection_menu.js"></script>
	<script src="js/graphics/link.js"></script>
	<script src="js/graphics/node.js"></script>

	<script src="js/ui/handle_menu.js"></script>

	<script src="js/simulation.js"></script>
	<script src="js/ui/export_button.js"></script>
	<script src="js/ui/menu.js"></script>

	<script>
		"use strict";

		// in which modes should "mechanic" components be enabled?
		sense4us.active_modes = ["edit"];

		function create_node(id, signal, signal_fire) {
			var node = sense4us.entities.node(id);
			node.set("name", "node_name");
			node.set("signal", signal);
			node.set("signal_fire", signal_fire);
			node.graphics = sense4us.graphics.node(node, sense4us.stage);
			sense4us.stage.addChild(node.graphics.container);
			sense4us.stage.update();
			sense4us.mechanics.draggable(node.graphics, sense4us.active_modes);

			return node;
		}

		function create_origin_node(id, signal, signal_fire) {
			var node = sense4us.entities.node(id);
			node.set("name", "node_name");
			node.set("signal", signal);
			node.set("signal_fire", signal_fire);
			node.graphics = sense4us.graphics.node(node, sense4us.stage, "origin");
			node.graphics.set_variable("signal_fire");
			sense4us.stage.addChild(node.graphics.container);
			sense4us.stage.update();
			sense4us.mechanics.draggable(node.graphics, sense4us.active_modes);

			return node;
		}

		function create_link(start, end, co, t) {
			var link = sense4us.entities.link(null, start, end, co, t);
			link.graphics = sense4us.graphics.link(link, sense4us.stage);

			sense4us.stage.addChildAt(link.graphics.container, 0);
			sense4us.stage.update();
			sense4us.mechanics.selectable(link.graphics);

			return link;
		}

		sense4us.init_easeljs();

		sense4us.selection_menu = sense4us.entities.selection_menu();
		sense4us.selection_menu.graphics = sense4us.graphics.selection_menu(sense4us.selection_menu, sense4us.stage);
		sense4us.mechanics.selection_menu(sense4us.selection_menu.graphics.dragging_thingy);

		var node2 = create_node(null, 0, 0);
		var node3 = create_node(null, 0, 0);

		sense4us.events.bind("object_updated", function(object) {
			sense4us.stage.update();
		});
		
		sense4us.menu.open("edit");
	</script>
</body>
</html>

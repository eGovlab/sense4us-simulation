'use strict';

var hitTest      = require('collisions').hitTest,
    objectHelper = require('object-helper');

function activateLinking(data) {
    var nodeGui = data.nodeGui;
    var collidedNodes = objectHelper.filter.call(nodeGui, function(node) {
        return hitTest(node, data.pos);
    });

    collidedNodes = objectHelper.slice.call(collidedNodes, -1);
    objectHelper.forEach.call(collidedNodes, function(node) {
        node.offsetX = data.pos.x - (node.x || 0);
        node.offsetY = data.pos.y - (node.y || 0);

        node.linking = true;
    });
}

module.exports = activateLinking;
'use strict';

var modelLayer   = require('model_layer'),
    objectHelper = require('object-helper');

function addStoreModelListeners(savedModels, loadedModel) {
    /**
     * @description A new model should be stored and moved away from the currently loaded one.
     * @event storeModel
     * @memberof module:model/propagationEvents
     */
    loadedModel.addListener('storeModel', function() {
        var m;
        if(loadedModel.synced === true) {
            m = modelLayer.moveModel(loadedModel);
            console.log('Moved model', m);
            savedModels.synced[loadedModel.syncId] = m;
            if(savedModels.local[m.id]) {
                savedModels.local[m.id] = m;
            }
        } else {
            console.log('Moved local model:', m);
            m = modelLayer.moveModel(loadedModel);
            savedModels.local[loadedModel.id] = m;
        }
    });
}

module.exports = addStoreModelListeners;
